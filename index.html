<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Supabase Auth Example</title>
  </head>
  <body>
    <h1>Регистрация</h1>
    <form id="signupForm">
      <label for="email">Email:</label><br />
      <input type="email" id="signupEmail" name="email" required /><br />
      <label for="password">Пароль:</label><br />
      <input
        type="password"
        id="signupPassword"
        name="password"
        required
      /><br />
      <button type="submit">Зарегистрироваться</button>
    </form>

    <h1>Вход</h1>
    <form id="loginForm">
      <label for="email">Email:</label><br />
      <input type="email" id="loginEmail" name="email" required /><br />
      <label for="password">Пароль:</label><br />
      <input
        type="password"
        id="loginPassword"
        name="password"
        required
      /><br />
      <button type="submit">Войти</button>
    </form>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
    <script>
      // Инициализация Supabase клиента
      const supabaseUrl = "https://qkmqzhrosivywepflhtq.supabase.co";
      const supabaseKey =
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFrbXF6aHJvc2l2eXdlcGZsaHRxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTA3Nzk1NjUsImV4cCI6MjAyNjM1NTU2NX0.8QjJ1W7X0MTS-kPkSr2MzuM3Jjrq8F4H6EYQBEa5a7o";
      const { createClient } = supabase;
      const supabaseClient = createClient(supabaseUrl, supabaseKey);

      document
        .getElementById("signupForm")
        .addEventListener("submit", async function (event) {
          event.preventDefault();
          const email = document.getElementById("signupEmail").value;
          const password = document.getElementById("signupPassword").value;
          try {
            const { data, error } = await supabaseClient.auth.signUp({
              email: email,
              password: password,
            });
            if (error) {
              console.error("Error signing up:", error.message);
              // Show error message to the user
            } else {
              console.log("User signed up successfully:", data);
              // Redirect or show success message
            }
          } catch (error) {
            console.error("Error signing up:", error.message);
          }
        });

      document
        .getElementById("loginForm")
        .addEventListener("submit", async function (event) {
          event.preventDefault();
          const email = document.getElementById("loginEmail").value;
          const password = document.getElementById("loginPassword").value;
          try {
            const { user, error } =
              await supabaseClient.auth.signInWithPassword({
                email: email,
                password: password,
              });
            if (error) {
              console.error("Error signing in:", error.message);
              // Show error message to the user
            } else {
              console.log("User signed in successfully:", user);
              window.location.href = "dashboard.html"; // Перенаправляем пользователя на страницу панели пользователя
            }
          } catch (error) {
            console.error("Error signing in:", error.message);
          }
        });
    </script>
  </body>
</html>
